<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>connectr+</title>
  <style>
    @font-face{font-family:'Garet';src: local('Garet');font-style:normal; font-weight:100 900; font-display:swap;}
    :root{--purple:#5E17EB;--neon:#C1FF72;--bg:#0A0A0B;--fg:#F5F7FA;--muted:#A1A1AA;--card:#101114;--line:#1b1c20;--radius:18px;--shadow:0 10px 25px rgba(0,0,0,0.35);--danger:#ff4d6a;}
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:radial-gradient(circle at top, #141522 0, #050506 55%);color:var(--fg);font-family:'Garet',ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;}
    a{color:inherit;text-decoration:none}
    .app{display:grid;grid-template-rows:72px 1fr;min-height:100vh;max-width:1200px;margin:0 auto;padding:0 12px 0 12px;}
    header{display:flex;align-items:center;justify-content:space-between;padding:16px 8px;gap:16px;position:sticky;top:0;z-index:10;background:rgba(5,5,8,.88);backdrop-filter:blur(12px);border-bottom:1px solid var(--line);}
    .brand{display:flex;align-items:center;gap:12px;font-weight:800;letter-spacing:.2px;}
    .logo{width:38px;height:38px;display:grid;place-items:center;border-radius:10px;background:radial-gradient(circle at 20% 0, #c1ff72, #5e17eb);color:white;position:relative;box-shadow:0 0 18px rgba(193,255,114,.55);}
    .logo::after{content:'+';position:absolute;right:-7px;top:-7px;width:18px;height:18px;border-radius:6px;display:grid;place-items:center;background:var(--neon);color:#101114;font-size:12px;font-weight:900;box-shadow:0 0 12px rgba(193,255,114,.7);}
    .brand-name{font-size:22px}
    .brand-tag{font-size:11px;color:var(--muted);margin-top:2px}
    .header-center{display:flex;gap:8px;align-items:center;}
    .header-auth{display:flex;gap:8px;align-items:center;}
    .btn{appearance:none;border:1px solid var(--line);background:#15161a;color:var(--fg);padding:9px 13px;border-radius:999px;cursor:pointer;font-weight:700;font-size:13px;display:inline-flex;align-items:center;gap:6px;transition:background .18s ease,border-color .18s ease,transform .12s ease,box-shadow .12s ease;white-space:nowrap;}
    .btn:hover{background:#191b20;transform:translateY(-1px);box-shadow:0 8px 18px rgba(0,0,0,.4);}
    .btn.purple{background:var(--purple);border-color:transparent;color:#fdfdff}
    .btn.purple:hover{background:#6b26ff}
    .btn.neon{background:var(--neon);color:#121212;border-color:transparent;box-shadow:0 0 16px rgba(193,255,114,.45)}
    .btn.ghost{background:transparent}
    .btn.small{padding:6px 10px;font-size:12px}
    .btn.icon-only{padding:6px 8px;border-radius:12px}
    .pill{display:inline-flex;align-items:center;gap:8px;background:linear-gradient(90deg,rgba(97,104,255,.18),rgba(193,255,114,.05));border:1px solid rgba(97,104,255,.4);border-radius:999px;padding:6px 10px;color:var(--neon);font-weight:800;font-size:11px;text-transform:uppercase;letter-spacing:.06em;}
    main{display:grid;grid-template-rows:1fr 72px;padding-top:4px;}
    .view{display:none;padding:20px 4px 10px;}
    .view.active{display:block}
    nav{position:sticky;bottom:0;left:0;right:0;border-top:1px solid var(--line);background:rgba(5,5,7,.97);backdrop-filter:blur(10px);height:72px;display:grid;grid-template-columns:repeat(5,1fr);}
    .nav-btn{position:relative;display:grid;place-items:center;color:#bcbcc2;font-size:11px;font-weight:700;gap:4px;cursor:pointer;}
    .nav-btn svg{width:22px;height:22px;display:block;fill:currentColor;}
    .nav-btn::before{content:"";position:absolute;inset:auto 18px 10px 18px;height:6px;border-radius:999px;background:transparent;transform:translateY(6px);transition:all .25s ease;}
    .nav-btn.active{color:#ffffff}
    .nav-btn.active::before{background:var(--neon)}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:16px;}
    .card{background:radial-gradient(circle at top left,#141521,#0b0b0f);border:1px solid var(--line);border-radius:var(--radius);box-shadow:var(--shadow);padding:18px;display:flex;flex-direction:column;gap:12px;position:relative;overflow:hidden;}
    .card::after{content:"";position:absolute;inset:auto -40% -80%;height:120%;background:radial-gradient(circle at 10% 0,rgba(193,255,114,.12),transparent 55%);opacity:.75;pointer-events:none;}
    .row{display:flex;gap:12px;align-items:center}
    .row.spread{justify-content:space-between}
    .muted{color:var(--muted)}
    .badge{padding:3px 8px;border-radius:999px;border:1px solid rgba(97,104,255,.6);font-size:10px;text-transform:uppercase;letter-spacing:.08em;color:var(--neon);background:rgba(31,34,80,.7);}
    .chip{padding:4px 9px;border-radius:999px;border:1px solid var(--line);font-size:11px;color:var(--muted);}
    input[type=text],input[type=email],input[type=password],input[type=number],input[type=date],select,textarea{width:100%;padding:11px 13px;border:1px solid var(--line);border-radius:12px;background:#0f1013;color:var(--fg);font-family:inherit;font-size:13px;}
    textarea{min-height:120px;resize:vertical}
    label{font-size:12px;color:var(--muted);display:block;margin-bottom:4px}
    .seg{display:flex;gap:8px;flex-wrap:wrap}
    .seg .seg-btn{padding:8px 10px;border:1px solid var(--line);border-radius:10px;cursor:pointer;background:#0f1013;color:var(--fg);font-size:12px;}
    .seg .seg-btn.active{border-color:var(--purple);color:var(--neon);font-weight:800;box-shadow:0 0 14px rgba(94,23,235,.5);}
    .hero{padding:30px 0 10px;display:grid;grid-template-columns:minmax(0,2.1fr) minmax(0,1.4fr);gap:22px;align-items:center;}
    .headline{font-size:46px;line-height:1.02;margin:14px 0 6px 0;font-weight:900;letter-spacing:-.5px;}
    .headline span.accent{color:var(--neon);text-shadow:0 0 22px rgba(193,255,114,.5);}
    .sub{color:#c7c7cf;max-width:60ch;font-size:14px;}
    .hero-metrics{display:flex;gap:14px;flex-wrap:wrap;margin-top:18px;font-size:12px;color:var(--muted);}
    .hero-metric span{display:block;font-size:18px;font-weight:800;color:var(--neon);}
    .hero-right{border-radius:24px;border:1px solid rgba(97,104,255,.6);padding:16px 16px 18px;background:radial-gradient(circle at top,#211b36,#080810);box-shadow:0 0 35px rgba(40,18,90,.9);position:relative;overflow:hidden;}
    .hero-right::before{content:"";position:absolute;inset:-40% 20% auto;height:120px;background:radial-gradient(circle at 50% 0,rgba(193,255,114,.35),transparent 55%);opacity:.9;mix-blend-mode:screen;pointer-events:none;}
    .hero-right-title{font-size:13px;font-weight:700;margin-bottom:6px}
    .hero-list{margin-top:8px;display:flex;flex-direction:column;gap:6px;font-size:12px;}
    .hero-dot{width:7px;height:7px;border-radius:50%;background:var(--neon);box-shadow:0 0 12px rgba(193,255,114,.7);}
    .section-title{font-size:16px;font-weight:800;margin-bottom:4px;}
    .section-eyebrow{font-size:11px;text-transform:uppercase;letter-spacing:.1em;color:var(--muted);}
    .list{display:flex;flex-direction:column;gap:12px}
    .list-item{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:12px;border:1px solid var(--line);border-radius:12px;background:#0f1013;}
    .list-item.clickable{cursor:pointer}
    .avatar{width:40px;height:40px;border-radius:50%;background:radial-gradient(circle at 0 0,#5e17eb,#171821);display:grid;place-items:center;font-weight:800;color:#e2e2e8;}
    .bubble{max-width:70%;padding:10px 12px;border-radius:14px;border:1px solid var(--line);font-size:13px;}
    .bubble.me{background:var(--purple)}
    .bubble.them{background:#171821}
    .modal{position:fixed;inset:0;background:rgba(0,0,0,.55);display:none;align-items:center;justify-content:center;padding:18px;z-index:30;}
    .modal .sheet{background:#111216;border:1px solid var(--line);border-radius:18px;width:min(780px,92vw);padding:18px;box-shadow:0 24px 55px rgba(0,0,0,.6);color:var(--fg);position:relative;overflow:hidden;}
    .modal .sheet::before{content:"";position:absolute;inset:-40% 10% auto;height:140px;background:radial-gradient(circle at 30% 0,rgba(193,255,114,.2),transparent 55%);opacity:.7;pointer-events:none;}
    .pill-warning{font-size:11px;color:var(--danger);}
    .auth-tabs{display:flex;gap:6px;padding:4px;border-radius:999px;background:#060608;border:1px solid var(--line);margin-bottom:12px;width:max-content;}
    .auth-tab{padding:6px 14px;border-radius:999px;font-size:12px;font-weight:700;cursor:pointer;color:var(--muted);}
    .auth-tab.active{background:var(--purple);color:white;}
    .error-text{color:var(--danger);font-size:12px;margin-top:4px;}
    .tagline-glow{font-size:11px;color:var(--muted);text-transform:uppercase;letter-spacing:.15em;}
    .reveal{opacity:0;transform:translateY(18px);transition:opacity .6s ease, transform .6s ease;}
    .reveal.in{opacity:1;transform:none;}
    .cors-warning{background:rgba(255,77,106,.15);border:1px solid var(--danger);border-radius:12px;padding:12px;margin-top:8px;font-size:12px;}
    @media(min-width:880px){.headline{font-size:64px}}
    @media(max-width:820px){.hero{grid-template-columns:1fr;gap:18px;}}
    @media(max-width:720px){header{padding-inline:8px;gap:10px;}.header-center{display:none;}.brand-name{font-size:20px}.headline{font-size:36px}}
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div class="brand">
        <div class="logo">c</div>
        <div>
          <div class="brand-name">connectr<span style="color:var(--neon)">+</span></div>
          <div class="brand-tag">Campus marketplace, reimagined</div>
        </div>
      </div>
      <div class="header-center">
        <button class="btn ghost small" onclick="go('home')">Home</button>
        <button class="btn ghost small" onclick="go('search')">Browse</button>
        <button id="btnHeaderPost" class="btn purple small" onclick="onRequireAuth(()=>go('post'))">New listing</button>
      </div>
      <div class="header-auth" id="headerAuth"></div>
    </header>
    <main>
      <section id="home" class="view active">
        <div class="hero reveal">
          <div>
            <div class="pill">
              <span style="width:7px;height:7px;border-radius:50%;background:var(--neon);box-shadow:0 0 12px rgba(193,255,114,.8);"></span>
              connectr+ marketplace · beta
            </div>
            <div class="headline">Connect your <span class="accent">campus</span> in one trusted marketplace.</div>
            <p class="sub">Browse textbooks, tickets, tech, and more in a curated student-only space. Look around freely — then log in to favourite, message, and buy items in a single, secure flow.</p>
            <div class="hero-metrics">
              <div class="hero-metric"><span id="metricListings">5</span>active listings across your campus.</div>
              <div class="hero-metric"><span>0 %</span>bidding drama — just instant buys &amp; direct chats.</div>
              <div class="hero-metric"><span>3</span>steps from "found it" to "it's yours".</div>
            </div>
          </div>
          <div class="hero-right">
            <div class="tagline-glow">A premium experience for students</div>
            <div class="hero-right-title">Your next favourite item is probably already here.</div>
            <div class="hero-list">
              <div class="row"><div class="hero-dot"></div><div><strong>Search first.</strong><span class="muted"> Explore listings by title, category, or description — no login required.</span></div></div>
              <div class="row"><div class="hero-dot"></div><div><strong>Then sign in.</strong><span class="muted"> Register or log in to post, favourite, message, and buy instantly.</span></div></div>
              <div class="row"><div class="hero-dot"></div><div><strong>One tap to own it.</strong><span class="muted"> Use "Buy now" to lock the item so nobody else can purchase it.</span></div></div>
            </div>
            <div style="margin-top:14px;display:flex;gap:8px;flex-wrap:wrap;">
              <button class="btn neon small" onclick="openAuthModal('register')">Get started</button>
              <button class="btn ghost small" onclick="openAuthModal('login')">I already have an account</button>
            </div>
          </div>
        </div>
        <div class="grid reveal" style="margin-top:2px;">
          <div class="card">
            <div class="section-eyebrow">Our story</div>
            <div class="section-title">Built by students who were tired of messy group chats.</div>
            <p class="sub" style="font-size:13px;margin-top:4px;">connectr+ started as a small side project to replace chaotic WhatsApp threads, random spreadsheets, and overlapping Instagram stories. We wanted one calm, beautiful place where students could actually <em>find</em> what they're looking for – without spam or scams.</p>
            <div class="row" style="gap:8px;margin-top:6px;">
              <span class="chip">Designed for campus</span>
              <span class="chip">Trust-first</span>
              <span class="chip">Zero bidding wars</span>
            </div>
          </div>
          <div class="card">
            <div class="section-eyebrow">Our mission</div>
            <div class="section-title">Make student marketplaces feel premium, safe, and effortless.</div>
            <p class="sub" style="font-size:13px;margin-top:4px;">Our mission is to connect people, not just products. Every feature we ship is designed to make your campus feel smaller, safer, and more circular: better reuse, less waste, and more money staying within your community.</p>
            <ul style="margin:8px 0 0 15px;font-size:13px;color:var(--muted);padding-left:4px;">
              <li>Browse without logging in – no friction.</li>
              <li>Log in once to unlock favourites, messages, and instant buying.</li>
              <li>Clear pricing, no hidden auctions, no surprise bids.</li>
            </ul>
          </div>
        </div>
        <div class="card reveal" style="margin-top:18px;">
          <div class="row spread">
            <div><div class="section-eyebrow">Discover</div><h3 style="margin:2px 0 0 0">Trending listings</h3></div>
            <div class="muted">Browse now – log in later to buy.</div>
          </div>
          <div id="trendingGrid" class="grid" style="margin-top:10px"></div>
        </div>
      </section>
      <section id="search" class="view">
        <div class="card reveal">
          <div class="row" style="gap:10px;align-items:flex-end;flex-wrap:wrap;">
            <div style="flex:1 1 240px;"><label>Search marketplace</label><input id="searchInput" type="text" placeholder="Search by keyword, category, or description…"/></div>
            <div style="flex:0 0 auto;display:flex;gap:8px;">
              <button class="btn purple" onclick="runSearch()">Search</button>
              <button class="btn ghost" onclick="clearSearch()">Clear</button>
            </div>
          </div>
          <div class="muted" style="font-size:12px;margin-top:6px;">You can look around without an account. To post, favourite, message or buy, please log in.</div>
        </div>
        <div id="searchResults" class="grid reveal" style="margin-top:16px"></div>
      </section>
      <section id="favourites" class="view">
        <div class="row spread reveal" style="margin-bottom:12px"><h3 style="margin:0">Your favourites</h3><button class="btn small" onclick="clearFavourites()">Clear</button></div>
        <div id="favGrid" class="grid reveal"></div>
      </section>
      <section id="post" class="view">
        <div class="card reveal">
          <div class="row spread" style="margin-bottom:4px;"><h3 style="margin:0 0 8px 0">Create a listing</h3><div class="muted" style="font-size:12px;">Share something you want to sell or pass on.</div></div>
          <div class="grid" style="grid-template-columns:1fr;">
            <div class="row" style="align-items:flex-start; gap:16px; flex-wrap:wrap">
              <div style="flex:1 1 320px"><label>Title</label><input id="p_title" type="text" placeholder="Give your listing a clear title"/></div>
              <div style="flex:1 1 220px"><label>Category</label><input id="p_category" type="text" placeholder="e.g. Textbooks, Electronics, Tickets…"/></div>
            </div>
            <div><label>Description</label><textarea id="p_desc" placeholder="Describe the item, its condition, and any details students should know…"></textarea></div>
            <div class="row" style="gap:16px; flex-wrap:wrap">
              <div style="flex:1 1 160px"><label>Price (instant buy)</label><input id="p_price" type="number" min="0" step="0.01" placeholder="0.00"/></div>
              <div style="flex:1 1 220px"><label>Visibility</label><select id="p_visibility"><option value="public">Public to your campus</option><option value="friends">Only visible to people you share the link with</option></select></div>
            </div>
            <div class="row" style="gap:10px; margin-top:6px">
              <button class="btn neon" onclick="submitListing()">Publish listing</button>
              <div class="muted" style="font-size:11px;">By publishing, you agree that buyers can instantly secure your item at the listed price.</div>
            </div>
          </div>
        </div>
      </section>
      <section id="messages" class="view">
        <div class="row spread reveal" style="margin-bottom:10px"><div><div class="section-eyebrow">Inbox</div><h3 style="margin:2px 0 0 0">Messages</h3></div><div class="muted">Newest first</div></div>
        <div id="msgList" class="list reveal"></div>
      </section>
      <section id="profile" class="view">
        <div class="card reveal">
          <h3 style="margin:0 0 12px 0">Your profile</h3>
          <div class="row" style="gap:16px; align-items:flex-start; flex-wrap:wrap">
            <div class="row" style="gap:12px">
              <div class="avatar" id="avatar">U</div>
              <div><label>Name</label><input id="pf_name" type="text" placeholder="Your name"/><div class="muted" style="margin-top:4px;font-size:12px;">Member since <span id="pf_since">–</span></div></div>
            </div>
          </div>
          <div class="row" style="gap:12px; margin-top:12px; flex-wrap:wrap">
            <div style="flex:1 1 200px"><label>Location</label><input id="pf_location" type="text" placeholder="City / campus"/></div>
            <div style="flex:1 1 200px"><label>University</label><input id="pf_university" type="text" placeholder="University name"/></div>
          </div>
          <div class="row" style="gap:10px; margin-top:12px"><button class="btn purple" onclick="saveProfile()">Save profile</button></div>
        </div>
        <div class="grid reveal" style="margin-top:16px">
          <div class="card"><div class="row spread"><div class="muted">Listings online</div><div id="stat_listings">0</div></div></div>
          <div class="card"><div class="row spread"><div class="muted">Total favourites</div><div id="stat_favs">0</div></div></div>
          <div class="card"><div class="row spread"><div class="muted">Total purchases (coming soon)</div><div id="stat_purchases">0</div></div></div>
        </div>
      </section>
      <nav>
        <div class="nav-btn active" data-view="home" onclick="switchView(this)"><svg viewBox="0 0 24 24"><path d="M12 3l9 8h-3v9h-5v-6H11v6H6v-9H3z"/></svg>Home</div>
        <div class="nav-btn" data-view="search" onclick="switchView(this)"><svg viewBox="0 0 24 24"><path d="M10 18a8 8 0 1 1 5.29-14.06L22 10.65l-1.41 1.41-3.7-3.7A8 8 0 0 1 10 18z"/></svg>Search</div>
        <div class="nav-btn" data-view="favourites" onclick="switchView(this)"><svg viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5A4.5 4.5 0 0 1 6.5 4c1.74 0 3.41.81 4.5 2.09A6 6 0 0 1 22 8.5c0 3.78-3.4 6.86-8.55 11.54z"/></svg>Favourites</div>
        <div class="nav-btn" data-view="messages" onclick="switchView(this)"><svg viewBox="0 0 24 24"><path d="M21 6h-18v12h4v4l6-4h8z"/></svg>Messages</div>
        <div class="nav-btn" data-view="profile" onclick="switchView(this)"><svg viewBox="0 0 24 24"><path d="M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5zm0 2c-4.42 0-8 2.24-8 5v3h16v-3c0-2.76-3.58-5-8-5z"/></svg>Profile</div>
      </nav>
    </main>
  </div>
  <div id="listingModal" class="modal" onclick="backdropClose(event)">
    <div class="sheet">
      <div class="row spread" style="position:relative;z-index:1;"><div><div class="section-eyebrow">Listing</div><h3 id="lm_title" style="margin:2px 0 0 0"></h3></div><button class="btn icon-only" onclick="closeModal('listingModal')">✕</button></div>
      <div id="lm_desc" class="muted" style="margin:8px 0 14px 0"></div>
      <div id="lm_price" style="font-size:18px;font-weight:800;margin-bottom:4px;"></div>
      <div id="lm_meta" class="muted" style="margin-top:2px;font-size:12px;"></div>
      <div class="row" style="gap:10px; flex-wrap:wrap; margin-top:14px;position:relative;z-index:1;">
        <button class="btn neon" id="lm_buy" onclick="buyNow()">Buy now</button>
        <button class="btn purple" onclick="startChat()">Message seller</button>
        <span class="pill-warning" id="lm_guestHint" style="display:none;">Log in to message or buy.</span>
      </div>
    </div>
  </div>
  <div id="chatModal" class="modal" onclick="backdropClose(event)">
    <div class="sheet">
      <div class="row spread" style="position:relative;z-index:1;"><h3 id="chatTitle" style="margin:0"></h3><button class="btn icon-only" onclick="closeModal('chatModal')">✕</button></div>
      <div id="chatThread" style="display:flex;flex-direction:column;gap:10px;margin:12px 0;max-height:45vh;overflow:auto"></div>
      <div class="row" style="gap:8px;position:relative;z-index:1;"><input id="chatInput" type="text" placeholder="Write a message…"/><button class="btn purple" onclick="sendChat()">Send</button></div>
    </div>
  </div>
  <div id="authModal" class="modal" onclick="backdropClose(event)">
    <div class="sheet" style="max-width:480px;">
      <div class="row spread" style="position:relative;z-index:1;margin-bottom:8px;"><div><div class="section-eyebrow" id="authEyebrow">Welcome</div><h3 id="authTitle" style="margin:2px 0 0 0">Log in</h3></div><button class="btn icon-only" onclick="closeModal('authModal')">✕</button></div>
      <div class="auth-tabs">
        <div id="tabLogin" class="auth-tab active" onclick="switchAuthMode('login')">Log in</div>
        <div id="tabRegister" class="auth-tab" onclick="switchAuthMode('register')">Register</div>
      </div>
      <div id="authFormLogin">
        <div style="margin-bottom:8px;"><label>Email</label><input id="login_email" type="email" placeholder="you@university.edu"/></div>
        <div style="margin-bottom:6px;"><label>Password</label><input id="login_password" type="password" placeholder="••••••••"/></div>
        <div id="
